====================================================================
ピボット高値安値とは
====================================================================

【定義】
ピボット高値安値は、価格チャート上で周囲よりも明確に高い（または低い）
価格ポイントのことです。テクニカル分析において、重要なサポートレジスタンス
レベルとして機能します。

【視覚的なイメージ】
    
    価格
     ^
     |
     |          ピボット高値（周囲より高い）
     |        / \
     |       /   \      次のピボット高値
     |      /     \   / \
     |     /       \ /   \
     |    /              \
     |   /                \
     |     ピボット安値      ピボット安値
     | (周囲より低い)
     |
     +-----------------------------------------> 時間


【本システムでの実装】

1. データ範囲: 過去5営業日分のローソク足データを参照
   
2. 検出アルゴリズム: scipy.signal.find_peaks()を使用
   - 高値のピーク検出: find_peaks(high_prices)
   - 安値のピーク検出: find_peaks(-low_prices)  マイナス反転で谷を検出

3. パラメータ:
   - min_distance: 2本（ピーク間の最小距離）
      近すぎるピークを統合
   
   - prominence: 0.5（ピークの顕著性）
      周囲に比べてどれだけ突出しているか


【ピボット高値（Pivot High）】
周囲の高値よりも明確に高い価格ポイント
 レジスタンス（上値抵抗線）として機能

例: 過去のピーク価格で売り圧力が強まり、
    価格が上昇しにくくなる

【ピボット安値（Pivot Low）】
周囲の安値よりも明確に低い価格ポイント
 サポート（下値支持線）として機能

例: 過去の底値で買い圧力が強まり、
    価格が下落しにくくなる


【カウンタートレード戦略での活用】

1. エントリー判断:
   - 価格がピボット安値に接近  買いエントリー候補
   - 価格がピボット高値に接近  売りエントリー候補

2. 利確目標:
   - 買いポジション  次のピボット高値で利確
   - 売りポジション  次のピボット安値で利確

3. 損切りライン:
   - レベルを明確にブレイクした場合


【実際のバックテスト結果】
runs/20260124_204757/output/levels.jsonl を見ると:
- 3350: pivot_high（527.5, 529.7等）、pivot_low（525.6, 527.5等）
- トレードではpivot_low（527.58付近）がサポートラインとして使用されていた


【他のレベルタイプとの違い】

レベルタイプ      | 特徴
-----------------+------------------------------
pivot_sr         | 実際の価格動きから検出
(最重要)         | 市場参加者の心理を反映
-----------------+------------------------------
consolidation    | 横ばいゾーンから検出
                 | 値固まりの水平ライン
-----------------+------------------------------
psychological    | キリ番（500円、1000円等）
                 | 人間の心理的な節目
-----------------+------------------------------
ma5/ma25         | 移動平均線
                 | トレンドの方向性を示す


【重要なポイント】
 過去のデータのみを使用（データリーク防止）
 同一価格帯のレベルは統合（0.3%以内）
 重み1.0で最も信頼性が高い
 銘柄あたり最大20レベルに絞り込み

===================================================================